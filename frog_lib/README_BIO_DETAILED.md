# -*- coding: utf-8 -*-
"""
БиоФрог: Биологически достоверная версия агента-лягушки

README для версии 2.0 с полной биологической достоверностью
"""

# BioFrog v2.0 - Биологически Достоверная Симуляция Нейросети Лягушки

## Обзор проекта

BioFrog v2.0 - это полностью переработанная версия симуляции нейросети лягушки с реалистичными биологическими компонентами. Проект сочетает высокую биологическую достоверность с производительностью в реальном времени (FPS > 30).

## Архитектура

### Ядро симуляции (`core/`)

#### `biological_neuron.py`
- **LIFNeuron**: Базовый интегрирующий нейрон с утечкой
  - Параметры: мембранный потенциал, порог спайкования, рефрактерный период
  - Методы: integrate(), reset()

- **PyramidalNeuron**: Пирамидальный нейрон с нелинейной дендритной интеграцией
  - Раздельные входы: базальные дендриты, апикальные дендриты
  - Дендритные плато для усиления коррелированных входов
  - Методы: integrate(dt, basal_input, apical_input)

- **FastSpikingInterneuron**: Быстро спайкающий интернейрон с адаптацией
  - Короткие мембранные постоянные времени (5мс)
  - Адаптационный ток
  - Методы: integrate(dt, input_current)

#### `synapse_models.py`
- **BiologicalSynapse**: Полная биологическая модель синапса
  - STDP обучение (Spike-Timing-Dependent Plasticity)
  - Короткая пластичность (facilitation/depression)
  - Нейромодуляция (дофамин, серотонин, ацетилхолин)
  - Методы: apply_stdp(), apply_short_term_plasticity(), transmit()

- **DynamicSynapse**: Синапс с усиленной краткосрочной пластичностью
  - Depressing (истощающиеся) синапсы
  - Facilitating (усиливающиеся) синапсы

#### `glial_cells.py`
- **Astrocyte**: Модель астроцита
  - Кальциевая динамика
  - Выброс глиотрансмиттеров (глутамат, АТФ)
  - Модуляция синаптической передачи
  - Методы: respond_to_neural_activity(), modulate_synapses()

- **GlialNetwork**: Сеть астроцитов
  - Пространственная организация (сетка)
  - Локальная модуляция нейромодуляторов
  - Методы: update(), get_local_modulation()

#### `neurotransmitter_diffusion.py`
- **NeurotransmitterDiffusion**: Модель пространственной диффузии
  - Диффузионное уравнение с затуханием
  - Картирование концентраций нейромодуляторов
  - Методы: release(), diffuse(), get_concentration()

- **MultiNeurotransmitterSystem**: Система управления несколькими модуляторами
  - Дофамин, серотонин, ацетилхолин, ГАБА, глутамат

### Архитектура (`architecture/`)

#### `visual_system.py`
- **CenterSurroundFilter**: Рецептивные поля на сетчатке
  - ON-center и OFF-center клетки
  - Гауссова организация
  
- **RetinalProcessing**: Визуальная обработка
  - Сетка рецептивных полей (10x10 по умолчанию)
  - Карты внимания
  - Методы: process_visual_input(), get_spatial_attention_map()

#### `tectum.py`
- **TectalColumn**: Колонка в тектуме
  - Селективность к направлению движения
  - Слои: пирамидальные нейроны → интернейроны → выходные нейроны
  - Методы: process_visual_input()

- **Tectum**: Полный тектум
  - 16 колонок с разными предпочтительными направлениями
  - Декодирование направления движения
  - Методы: process(), get_movement_command()

#### `motor_hierarchy.py`
- **MotorHierarchy**: Иерархическое управление движениями
  - Executive слой: принятие решений (4 нейрона)
  - Coordination слой: координация (8 интернейронов)
  - Motor слой: управление мышцами (12 нейронов)
  - Проприоцептивная обратная связь
  - Методы: execute_movement_command(), process_tongue_action()

### Метаболизм (`metabolism/`)

#### `systemic_metabolism.py`
- **NeuronMetabolism**: Энергетика отдельного нейрона
  - АТФ-зависимые процессы
  - Влияние энергии на возбудимость
  - Методы: consume_energy(), recover_energy(), affects_excitability()

- **SystemicMetabolism**: Системный метаболизм
  - Уровни глюкозы и кислорода
  - Циркадный ритм (усталость)
  - Накопление лактата
  - Методы: update(), get_metabolic_state()

### Пластичность (`plasticity/`)

#### `structural_plasticity.py`
- **StructuralPlasticityManager**: Изменения структуры синапсов
  - Усиление активных синапсов
  - Элиминация неактивных синапсов
  - Методы: update_structure()

#### `functional_plasticity.py`
- **FunctionalPlasticityManager**: Функциональные изменения
  - Гомеостатическое масштабирование (homeostatic scaling)
  - Внутренняя пластичность (intrinsic plasticity)
  - Методы: apply_homeostatic_scaling(), apply_intrinsic_plasticity()

## Использование

### Базовый пример

```python
import pygame
from bio_frog_v2 import BioFrogAgent, BioFlyCatchingSimulation

# Создать симуляцию с биологической сетью
simulation = BioFlyCatchingSimulation(width=800, height=600, bio_mode=True)

# Запустить симуляцию
simulation.run_simulation(max_steps=20000)

# Построить графики результатов
simulation.plot_results()
```

### Переключение режимов

```python
# Биологический режим (полная детализация)
sim_bio = BioFlyCatchingSimulation(bio_mode=True)

# Классический режим (оптимизированная производительность)
sim_classic = BioFlyCatchingSimulation(bio_mode=False)
```

## Производительность

- **FPS**: 30-60 FPS на стандартном оборудовании
- **Оптимизации**:
  - Низкое разрешение сетки для диффузии (20х20)
  - Кэширование рецептивных полей
  - Векторизованные операции NumPy
  - Периодические обновления (каждые 10 шагов) для дорогостоящих операций

## Биологическая валидация

### Реалистичные параметры

- **Мембранные постоянные времени**: 5-20 мс для разных типов нейронов
- **Рефрактерные периоды**: 1-2 мс для быстро спайкающих нейронов
- **STDP окно**: 50 мс
- **Синаптические постоянные времени**: 50-200 мс
- **Энергопотребление**: пропорционально частоте спайков

### Проверенные свойства

1. **Направленная селективность**: Тектальные колонки показывают нелинейную селективность к направлению движения
2. **Модуляция нейромодуляторов**: Дофамин и серотонин модулируют пластичность синапсов
3. **Гомеостаз**: Глиальные клетки и внутренняя пластичность поддерживают стабильную активность
4. **Энергетическое влияние**: Низкий уровень АТФ снижает возбудимость и способность к обучению

## Будущие улучшения

- [ ] Более сложные модели дендритных вычислений
- [ ] Пластичность, зависимая от неодулятора (neuromodulator-dependent plasticity)
- [ ] Спонтанная активность и фоновая стимуляция
- [ ] Развитие и критические периоды
- [ ] Дополнительные типы нейронов и нейротрансмиттеров

## Лицензия и авторство

BioFrog v2.0 © 2025 BioFrog Development Team
Проект вдохновлён биологией земноводных и современными знаниями о вычислениях в нервной системе.

## Ссылки

- [Фундаментальная нейробиология](https://www.elsevier.com/books/fundamental-neuroscience/squire/978-0-12-812443-2)
- [Вычислительная нейробиология лягушки](https://en.wikipedia.org/wiki/Frog_nervous_system)
- [STDP обучение](https://en.wikipedia.org/wiki/Spike-timing-dependent_plasticity)
